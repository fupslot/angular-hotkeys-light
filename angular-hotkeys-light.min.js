!function(e){e.module("fps.hotkeys",[]).service("Hotkeys",["$Hotkeys",function(e){return new e}]).provider("$Hotkeys",function(){function e(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=function(e){for(var t={},r=[],o=0;o<e.length;++o)t[e[o]]||r.push(e[o]),t[e[o]]=!0;return r},o=this.KEY_CODES={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",191:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};this.$get=["$rootScope","$window",function(n,i){var s=function(e){return function(t,r){n.$apply(function(){e.call(this,t,r)}.bind(this))}},y=function(t){this.id=t.id||e(),this.key=t.key,this.context=t.context||null,this.callback=t.callback,this.args=t.args,this.onKeyUp=!1};y.prototype.clone=function(){return new y(this)};var a=function(){this._hotkeys={},this._hotkeysUp={},this._onKeydown=this._onKeydown.bind(this),this._onKeyup=this._onKeyup.bind(this),this.initialize()};return Object.defineProperty(a.prototype,"initialize",{value:function(){i.addEventListener("keydown",this._onKeydown,!0),i.addEventListener("keyup",this._onKeyup,!0)}}),Object.defineProperty(a.prototype,"_invokeHotkeyHandlers",{value:function(e,t,r){for(var o=0,n=r.length;n>o;o++)try{var i=r[o];i.callback.call(i.context,e,i.args)}catch(s){console.error("HotKeys: ",i.key,s.message)}}}),Object.defineProperty(a.prototype,"_onKeydown",{value:function(e){var t=this.keyStringFromEvent(e);this._hotkeys[t]&&this._invokeHotkeyHandlers(e,t,this._hotkeys[t])},writable:!0}),Object.defineProperty(a.prototype,"_onKeyup",{value:function(e){var t=this.keyStringFromEvent(e);this._hotkeysUp[t]&&this._invokeHotkeyHandlers(this._hotkeysUp[t],t)},writable:!0}),Object.defineProperty(a.prototype,"keyStringFromEvent",{value:function(e){var t=[],n=e.which;return n=o[n]?o[n]:String.fromCharCode(n).toLowerCase(),e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),e.metaKey&&t.push("meta"),t.push(n),r(t).join("+")}}),Object.defineProperty(a.prototype,"_deregisterHotkey",{value:function(e){var t,r=this._hotkeys;if(e.onKeyUp&&(r=this._hotkeysUp),r[e.key])for(var o=r[e.key],n=0;n<o.length;++n){var i=o[n];(e.callback===i.callback&&i.context===e.context||e.id===i.id)&&(t=o.splice(n,1))}return t}}),Object.defineProperty(a.prototype,"deregisterHotkey",{value:function(e){var r=[];if(this._validateHotkey(e),t(e.key))for(var o=e.key.length-1;o>=0;o--){var n=e.clone();n.key=e.key[o];var i=this._deregisterHotkey(n);void 0!==i&&r.push(i[0])}else r.push(this._deregisterHotkey(e));return r}}),Object.defineProperty(a.prototype,"_validateHotkey",{value:function(e){if(!(e instanceof y))throw new TypeError("Hotkeys: Expected a hotkey object be instance of HotKey")}}),Object.defineProperty(a.prototype,"_registerKey",{value:function(e){var t=this._hotkeys;return e.onKeyUp&&(t=this._hotkeysUp),t[e.key]=t[e.key]||[],t[e.key].push(e),e}}),Object.defineProperty(a.prototype,"_registerKeys",{value:function(r){var o=[];if(t(r.key))for(var n=r.key.length-1;n>=0;n--){var i=r.clone();i.id=e(),i.key=r.key[n],o.push(this._registerKey(i))}else o.push(this._registerKey(r));return o}}),Object.defineProperty(a.prototype,"registerHotkey",{value:function(e){return this._validateHotkey(e),this._registerKeys(e)}}),Object.defineProperty(a.prototype,"registerHotkeyUp",{value:function(e){this._validateHotkey(e),e.onKeyUp=!0,this._registerKeys(e)}}),Object.defineProperty(a.prototype,"createHotkey",{value:function(e){if(null===e.key||void 0===e.key)throw new TypeError('HotKeys: Argument "key" is required');if(null===e.callback||void 0===e.callback)throw new TypeError('HotKeys: Argument "callback" is required');return e.callback=s(e.callback),new y(e)}}),Object.defineProperty(a.prototype,"match",{value:function(e,r){t(r)||(r=[r]);var o=this.keyStringFromEvent(e);return Boolean(~r.indexOf(o))}}),a}]})}(window.angular);